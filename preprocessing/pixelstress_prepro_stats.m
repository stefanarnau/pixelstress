clear all;

% PATH VARS
PATH_EEGLAB = '/home/plkn/eeglab2025.0.0/';
PATH_AUTOCLEANED = '/mnt/data_dump/pixelstress/2_autocleaned/';


subject_list = {'9_1',...
                '10_1',...
                '14_1',...
                '19_1',...
                '21_1',...
                '23_1',...
                '26_1',...
                '28_1',...
                '30_1',...
                '35_1',...
                '36_1',...
                '38_1',...
                '43_1',...
                '44_1',...
                '47_1',...
                '55_1',...
                '57_1',...
                '58_1',...
                '76_1',...
                '77_1',...
                '79_1',...
                '81_1',...
                '82_1',...
                '84_1',...
                '85_1',...
                '86_1',...
                '87_1',...
                '89_1',...
                '90_1',...
                '91_1',...
                '92_1',...
                '7_2',...
                '8_2',...
                '11_2',...
                '12_2',...
                '15_2',...
                '16_2',...
                '20_2',...
                '22_2',...
                '24_2',...
                '27_2',...
                '29_2',...
                '31_2',...
                '33_2',...
                '34_2',...
                '37_2',...
                '39_2',...
                '41_2',...
                '42_2',...
                '45_2',...
                '46_2',...
                '51_2',...
                '53_2',...
                '54_2',...
                '56_2',...
                '59_2',...
                '60_2',...
                '78_2',...
                '80_2',...
                '93_2',...
                '94_2',...
                '95_2',...
                '96_2',...
                '97_2',...
                '98_2'
               };

% Init eeglab
addpath(PATH_EEGLAB);
eeglab;

% A prepro-stats table
stats_abs = [];
stats_perc = [];

% Loop subjects
for s = 1 : length(subject_list)

    % Load erp data
    EEG_ERP = pop_loadset('filename', ['vp_', subject_list{s}(1 : end - 2), '_cleaned_erp.set'], 'filepath', PATH_AUTOCLEANED, 'loadmode', 'info');

    % Load tf data
    EEG_TF = pop_loadset('filename', ['vp_', subject_list{s}(1 : end - 2), '_cleaned_tf.set'], 'filepath', PATH_AUTOCLEANED, 'loadmode', 'info');

    % Fill stats
    stats_abs(s, :) = [EEG_ERP.trialinfo(1, 2).id, length(EEG_ERP.chans_rejected), length(EEG_ERP.rejected_epochs), length(EEG_ERP.nobrainer), length(EEG_TF.chans_rejected), length(EEG_TF.rejected_epochs), length(EEG_TF.nobrainer)];
    stats_perc(s, :) = [EEG_ERP.trialinfo(1, 2).id, length(EEG_ERP.chans_rejected) / 65, length(EEG_ERP.rejected_epochs) / 768, length(EEG_ERP.nobrainer) / 64, length(EEG_TF.chans_rejected) / 65, length(EEG_TF.rejected_epochs) / 768, length(EEG_TF.nobrainer) / 64];

end

mean(stats_abs(:, 2:end))
std(stats_abs(:, 2:end))